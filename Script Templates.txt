-- Script d'insertion des templates de notification
-- Suppression des donn√©es existantes pour √©viter les doublons
DELETE FROM notification_template WHERE code IN (
    'CREATION_TICKET',
    'MODIFICATION_STATUT_TICKET', 
    'AJOUT_SOLUTION',
    'CLOTURE_TICKET',
    'CODE_VALIDATION',
    'INTERVENTION_PLANIFIEE',
    'INTERVENTION_CONFIRMEE'
);

-- Insertion des templates
INSERT INTO notification_template (code, libelle, canal, sujet, contenu_html, actif, date_creation, date_mise_a_jour) 
VALUES 
-- Template pour cr√©ation de ticket
(
    'CREATION_TICKET',
    'Cr√©ation de ticket',
    'EMAIL',
    'Nouveau Ticket - {reference}',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour {utilisateur},</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Une nouvelle demande a √©t√© enregistr√©e dans notre syst√®me.</p>
    <div class=''info-card''>
        <h3>üìã D√©tails du Ticket</h3>
        <div class=''info-grid''>
            <div class=''info-row''>
                <div class=''info-label''>R√©f√©rence</div>
                <div class=''info-value''><span class=''highlight''>{reference}</span></div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Titre</div>
                <div class=''info-value''>{titre}</div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Statut Actuel</div>
                <div class=''info-value'' style="color: #F59E0B;">‚è≥ En Attente</div>
            </div>
        </div>
    </div>
    <div style="text-align: center; margin: 30px 0;">
        <a href="#" class="action-button">üìñ Voir le Ticket</a>
    </div>
    <p style="text-align: center; color: #718096; font-size: 14px;">Suivez l''avancement en temps r√©el sur votre portail</p>',
    1,
    GETDATE(),
    GETDATE()
),

-- Template pour modification de statut
(
    'MODIFICATION_STATUT_TICKET',
    'Modification de statut de ticket',
    'EMAIL', 
    'Statut Modifi√© - {reference}',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour {utilisateur},</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Le statut de votre ticket a √©t√© mis √† jour.</p>
    <div class=''info-card''>
        <h3>üîÑ √âvolution du Statut</h3>
        <div class=''info-grid''>
            <div class=''info-row''>
                <div class=''info-label''>Ticket</div>
                <div class=''info-value''><span class=''highlight''>{reference}</span></div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Ancien Statut</div>
                <div class=''info-value'' style="color: #EF4444;">{ancienStatut}</div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Nouveau Statut</div>
                <div class=''info-value'' style="color: #10B981;">{nouveauStatut}</div>
            </div>
        </div>
    </div>
    <div style="text-align: center; margin: 25px 0;">
        <a href="#" class="action-button">üìä Voir les D√©tails</a>
    </div>',
    1,
    GETDATE(),
    GETDATE()
),

-- Template pour ajout de solution
(
    'AJOUT_SOLUTION',
    'Ajout de solution',
    'EMAIL',
    '‚úÖ Solution Ajout√©e - {reference}',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour {utilisateur},</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Une solution a √©t√© ajout√©e √† votre ticket.</p>
    <div class=''info-card''>
        <h3>‚úÖ Solution Disponible</h3>
        <div class=''info-grid''>
            <div class=''info-row''>
                <div class=''info-label''>R√©f√©rence</div>
                <div class=''info-value''><span class=''highlight''>{reference}</span></div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Titre</div>
                <div class=''info-value''>{titre}</div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Statut</div>
                <div class=''info-value'' style="color: #10B981;">‚úÖ R√©solu</div>
            </div>
        </div>
    </div>
    <div style="text-align: center; margin: 30px 0;">
        <a href="#" class="action-button">üìñ Voir la Solution</a>
    </div>
    <p style="text-align: center; color: #718096; font-size: 14px;">Consultez la solution propos√©e pour votre demande</p>',
    1,
    GETDATE(),
    GETDATE()
),

-- Template pour cl√¥ture de ticket
(
    'CLOTURE_TICKET',
    'Cl√¥ture de ticket',
    'EMAIL',
    'üèÅ Ticket Cl√¥tur√© - {reference}',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour {utilisateur},</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Votre ticket a √©t√© cl√¥tur√© avec succ√®s.</p>
    <div class=''info-card''>
        <h3>üèÅ Bilan du Ticket</h3>
        <div class=''info-grid''>
            <div class=''info-row''>
                <div class=''info-label''>R√©f√©rence</div>
                <div class=''info-value''><span class=''highlight''>{reference}</span></div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Titre</div>
                <div class=''info-value''>{titre}</div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Statut Final</div>
                <div class=''info-value'' style="color: #10B981;">‚úÖ Cl√¥tur√©</div>
            </div>
        </div>
    </div>
    <div style="background: linear-gradient(135deg, #10B981 0%, #34D399 100%); color: white; padding: 25px; border-radius: 16px; text-align: center; margin: 25px 0;">
        <h3 style="margin: 0 0 10px 0; font-size: 20px;">üéâ Demande Trait√©e !</h3>
        <p style="margin: 0; opacity: 0.9;">Votre demande a √©t√© r√©solue avec succ√®s</p>
    </div>
    <p style="text-align: center; color: #718096; font-size: 14px;">Merci de nous avoir fait confiance</p>',
    1,
    GETDATE(),
    GETDATE()
),

-- Template pour code de validation
(
    'CODE_VALIDATION',
    'Code de validation',
    'EMAIL',
    'üîê Code de Validation - Portail Client',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour,</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Voici votre code de validation √† usage unique :</p>
    <div style="text-align: center; margin: 30px 0;">
        <span class="highlight" style="font-size: 32px; letter-spacing: 8px; padding: 15px 30px; background: linear-gradient(135deg, #8B5CF6 0%, #A78BFA 100%);">{code}</span>
    </div>
    <div style="background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 15px; border-radius: 8px; margin: 20px 0;">
        <p style="margin: 0; color: #92400E; font-size: 14px;">
            <strong>‚ö†Ô∏è Important :</strong> Ce code est valide pendant 10 minutes. Ne le partagez avec personne.
        </p>
    </div>',
    1,
    GETDATE(),
    GETDATE()
),

-- Template pour intervention planifi√©e
(
    'INTERVENTION_PLANIFIEE',
    'Intervention planifi√©e',
    'EMAIL',
    'üìÖ Intervention Planifi√©e - {reference}',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour {utilisateur},</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Une intervention a √©t√© programm√©e pour votre demande.</p>
    <div class=''info-card''>
        <h3>üìÖ Planning d''Intervention</h3>
        <div class=''info-grid''>
            <div class=''info-row''>
                <div class=''info-label''>R√©f√©rence</div>
                <div class=''info-value''><span class=''highlight''>{reference}</span></div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Date Propos√©e</div>
                <div class=''info-value'' style="color: #8B5CF6;">üìÖ {dateIntervention}</div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Action Requise</div>
                <div class=''info-value'' style="color: #F59E0B;">‚ö†Ô∏è Confirmation</div>
            </div>
        </div>
    </div>
    <div style="text-align: center; margin: 30px 0;">
        <a href="#" class="action-button">‚úÖ Confirmer la Date</a>
        <a href="#" class="action-button" style="background: linear-gradient(135deg, #6B7280 0%, #9CA3AF 100%); margin-left: 10px;">üîÑ Proposer Autre Date</a>
    </div>',
    1,
    GETDATE(),
    GETDATE()
),

-- Template pour intervention confirm√©e
(
    'INTERVENTION_CONFIRMEE',
    'Intervention confirm√©e',
    'EMAIL',
    '‚úÖ Intervention Confirm√©e - {reference}',
    '<p style="font-size: 18px; font-weight: 500; margin-bottom: 25px; color: #2D3748;">Bonjour {utilisateur},</p>
    <p style="margin-bottom: 20px; color: #4A5568;">Super ! La date d''intervention a √©t√© valid√©e avec succ√®s.</p>
    <div class=''info-card''>
        <h3>‚úÖ Rendez-vous Confirm√©</h3>
        <div class=''info-grid''>
            <div class=''info-row''>
                <div class=''info-label''>Ticket</div>
                <div class=''info-value''><span class=''highlight''>{reference}</span></div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Date Retenue</div>
                <div class=''info-value'' style="color: #10B981; font-size: 16px;">üóìÔ∏è {dateIntervention}</div>
            </div>
            <div class=''info-row''>
                <div class=''info-label''>Statut</div>
                <div class=''info-value'' style="color: #10B981;">üéØ Confirm√©</div>
            </div>
        </div>
    </div>
    <div style="background: linear-gradient(135deg, #10B981 0%, #34D399 100%); color: white; padding: 25px; border-radius: 16px; text-align: center; margin: 25px 0;">
        <h3 style="margin: 0 0 10px 0; font-size: 20px;">üéâ Parfait !</h3>
        <p style="margin: 0; opacity: 0.9;">Notre √©quipe interviendra √† la date convenue. Pr√©paration en cours...</p>
    </div>',
    1,
    GETDATE(),
    GETDATE()
);

-- V√©rification de l'insertion
SELECT code, libelle, sujet FROM notification_template WHERE actif = 1;